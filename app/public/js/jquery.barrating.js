!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){var e=function(){function e(){var e=this,n=function(n){return t.isNumeric(n)&&(n=Math.floor(n)),t('option[value="'+n+'"]',e.$elem)},a=function(t){var n=e.$elem.data("barrating");return void 0!==t?n[t]:n},i=function(t,n){null!==n&&"object"==typeof n?e.$elem.data("barrating",n):e.$elem.data("barrating")[t]=n},r=function(){return a("ratingText")},o=function(){return a("ratingValue")},l=function(){return a("userOptions").reverse?"nextAll":"prevAll"},s=function(t){n(t).prop("selected",!0),a("userOptions").triggerChange&&e.$elem.change()},u=function(t){(t=t||r())==a("emptyRatingText")&&(t=""),e.options.showSelectedRating&&e.$elem.parent().find(".br-current-rating").text(t)},d=function(){e.$widget.find("a").removeClass(function(t,e){return(e.match(/(^|\s)br-\S+/g)||[]).join(" ")})},g=function(){var n,i,r,s=e.$widget.find('a[data-rating-value="'+o()+'"]'),u=a("userOptions").initialRating,g=t.isNumeric(o())?o():0,c=(n=u,Math.round(Math.floor(10*n)/10%1*100));if(d(),s.addClass("br-selected br-current")[l()]().addClass("br-selected"),!a("ratingMade")&&t.isNumeric(u)){if(u<=g||!c)return;i=e.$widget.find("a"),(r=s.length?s[a("userOptions").reverse?"prev":"next"]():i[a("userOptions").reverse?"last":"first"]()).addClass("br-fractional"),r.addClass("br-fractional-"+c)}},c=function(n){(function(n){n.on("click.barrating",function(n){var l,d,c,p=t(this),f=a("userOptions");return n.preventDefault(),l=p.attr("data-rating-value"),d=p.attr("data-rating-text"),c=p,a("allowEmpty")&&a("userOptions").deselectable&&o()==c.attr("data-rating-value")&&(l=a("emptyRatingValue"),d=a("emptyRatingText")),i("ratingValue",l),i("ratingText",d),i("ratingMade",!0),s(l),u(d),g(),f.onSelect.call(e,o(),r(),n),!1})})(n),e.options.hoverState&&(n.on("mouseenter.barrating",function(){var e=t(this);d(),e.addClass("br-active")[l()]().addClass("br-active"),u(e.attr("data-rating-text"))}),e.$widget.on("mouseleave.barrating blur.barrating",function(){u(),g()}))},p=function(t){t.off(".barrating")},f=function(n){var i=e.$widget.find("a");a("userOptions").fastClicks&&i.on("touchstart.barrating",function(e){e.preventDefault(),e.stopPropagation(),t(this).click()}),n?(p(i),i.on("click.barrating",function(t){t.preventDefault()})):c(i)};this.show=function(){var r,o;a()||(r=["br-wrapper"],""!==e.options.theme&&r.push("br-theme-"+e.options.theme),e.$elem.wrap(t("<div />",{class:r.join(" ")})),function(){var a,r,o=(a=e.options.initialRating)?n(a):t("option:selected",e.$elem),l=!(r=e.$elem.find('option[value="'+e.options.emptyValue+'"]')).length&&e.options.allowEmpty?(r=t("<option />",{value:e.options.emptyValue})).prependTo(e.$elem):r,s=o.val(),u=o.data("html")?o.data("html"):o.text(),d=null!==e.options.allowEmpty?e.options.allowEmpty:!!l.length,g=l.length?l.val():null,c=l.length?l.text():null;i(null,{userOptions:e.options,ratingValue:s,ratingText:u,originalRatingValue:s,originalRatingText:u,allowEmpty:d,emptyRatingValue:g,emptyRatingText:c,readOnly:e.options.readonly,ratingMade:!1})}(),e.$widget=(o=t("<div />",{class:"br-widget"}),e.$elem.find("option").each(function(){var n,i,r,l;(n=t(this).val())!==a("emptyRatingValue")&&(i=t(this).text(),(r=t(this).data("html"))&&(i=r),l=t("<a />",{href:"#","data-rating-value":n,"data-rating-text":i,html:e.options.showValues?i:""}),o.append(l))}),e.options.showSelectedRating&&o.append(t("<div />",{text:"",class:"br-current-rating"})),e.options.reverse&&o.addClass("br-reverse"),e.options.readonly&&o.addClass("br-readonly"),o),e.$widget.insertAfter(e.$elem),g(),u(),f(e.options.readonly),e.$elem.hide())},this.readonly=function(t){"boolean"==typeof t&&a("readOnly")!=t&&(f(t),i("readOnly",t),e.$widget.toggleClass("br-readonly"))},this.set=function(t){var n=a("userOptions");0!==e.$elem.find('option[value="'+t+'"]').length&&(i("ratingValue",t),i("ratingText",e.$elem.find('option[value="'+t+'"]').text()),i("ratingMade",!0),s(o()),u(r()),g(),n.silent||n.onSelect.call(this,o(),r()))},this.clear=function(){var n=a("userOptions");i("ratingValue",a("originalRatingValue")),i("ratingText",a("originalRatingText")),i("ratingMade",!1),t("option",e.$elem).prop("selected",function(){return this.defaultSelected}),a("userOptions").triggerChange&&e.$elem.change(),u(r()),g(),n.onClear.call(this,o(),r())},this.destroy=function(){var t=o(),n=r(),i=a("userOptions");p(e.$widget.find("a")),e.$widget.remove(),e.$elem.removeData("barrating"),e.$elem.unwrap(),e.$elem.show(),i.onDestroy.call(this,t,n)}}return e.prototype.init=function(e,n){return this.$elem=t(n),this.options=t.extend({},t.fn.barrating.defaults,e),this.options},e}();t.fn.barrating=function(n,a){return this.each(function(){var i=new e;if(t(this).is("select")||t.error("Sorry, this plugin only works with select fields."),i.hasOwnProperty(n)){if(i.init(a,this),"show"===n)return i.show(a);if(i.$elem.data("barrating"))return i.$widget=t(this).next(".br-widget"),i[n](a)}else{if("object"==typeof n||!n)return a=n,i.init(a,this),i.show();t.error("Method "+n+" does not exist on jQuery.barrating")}})},t.fn.barrating.defaults={theme:"",initialRating:null,allowEmpty:null,emptyValue:"",showValues:!1,showSelectedRating:!0,deselectable:!0,reverse:!1,readonly:!1,fastClicks:!0,hoverState:!0,silent:!1,triggerChange:!0,onSelect:function(t,e,n){},onClear:function(t,e){},onDestroy:function(t,e){}},t.fn.barrating.BarRating=e});